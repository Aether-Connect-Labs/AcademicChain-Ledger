import { injectable } from 'inversify';import { createWriteStream } from 'fs';import { PDFDocument, rgb } from 'pdf-lib';import * as ExcelJS from 'exceljs';interface ReportFilters {}@injectable()export class EnterpriseReportService {  async generateVerificationReport(    enterpriseId: string,    format: 'pdf' | 'excel' | 'csv',    filters: ReportFilters  ): Promise<string> {    const verifications = await this.getVerifications(enterpriseId, filters);        switch (format) {      case 'pdf':        return this.generatePDF(verifications, enterpriseId);      case 'excel':        return this.generateExcel(verifications, enterpriseId);      case 'csv':        return this.generateCSV(verifications, enterpriseId);      default:        throw new Error('Unsupported report format');    }  }  private async getVerifications(enterpriseId: string, filters: ReportFilters): Promise<any[]> {    // Implement logic to fetch verifications from database    return [];  }  private async generatePDF(verifications: any[], enterpriseId: string): Promise<string> {    const pdfDoc = await PDFDocument.create();    const page = pdfDoc.addPage([600, 800]);    const { height } = page.getSize();        // TÃ­tulo    page.drawText(`Verification Report - ${enterpriseId}`, {      x: 50,      y: height - 50,      size: 20,      color: rgb(0, 0, 0)    });        // Contenido    verifications.forEach((v, i) => {      page.drawText(`${v.credentialId}: ${v.status}`, {        x: 50,        y: height - 100 - (i * 30),        size: 12,        color: v.status === 'Valid' ? rgb(0, 0.5, 0) : rgb(0.5, 0, 0)      });    });        const pdfBytes = await pdfDoc.save();    const filePath = `/reports/${enterpriseId}-${Date.now()}.pdf`;        return new Promise((resolve, reject) => {      const stream = createWriteStream(filePath);      stream.write(pdfBytes);      stream.end(() => resolve(filePath));      stream.on('error', reject);    });  }  private async generateExcel(verifications: any[], enterpriseId: string): Promise<string> {    const workbook = new ExcelJS.Workbook();    const worksheet = workbook.addWorksheet('Verifications');        // Cabeceras    worksheet.columns = [      { header: 'Credential ID', key: 'credentialId' },      { header: 'Student', key: 'studentName' },      { header: 'Status', key: 'status' },      { header: 'Date', key: 'date' }    ];        // Datos    worksheet.addRows(verifications);        // Estilos    worksheet.eachRow(row => {      const statusCell = row.getCell('status');      if (statusCell.value === 'Valid') {        statusCell.fill = {          type: 'pattern',          pattern: 'solid',          fgColor: { argb: 'FF00FF00' } // Green color        };      }    });        const filePath = `/reports/${enterpriseId}-${Date.now()}.xlsx`;    await workbook.xlsx.writeFile(filePath);    return filePath;  }  private async generateCSV(verifications: any[], enterpriseId: string): Promise<string> {    const header = 'Credential ID,Student,Status,Date
';    const rows = verifications.map(v => `${v.credentialId},${v.studentName},${v.status},${v.date}`).join('
');    const csvContent = header + rows;        const filePath = `/reports/${enterpriseId}-${Date.now()}.csv`;    return new Promise((resolve, reject) => {      createWriteStream(filePath).write(csvContent, (err) => {        if (err) reject(err);        else resolve(filePath);      });    });  }}